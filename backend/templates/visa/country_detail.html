{% extends "base.html" %}
{% load static %}

{% block title %}Visa {{ country.name }} — Hướng dẫn & Điều cần biết{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{% static 'visa/country_detail.css' %}">
{% endblock %}

{% block content %}

<!-- HERO -->
<section class="hero wow fadeIn" data-wow-duration="1.3s">
    <div class="container">
        <div class="row align-items-center">

            <!-- Text -->
            <div class="col-lg-7 text-white wow fadeInLeft" data-wow-delay="0.2s">
                <h1 class="display-6 fw-bold wow fadeInUp text-muted" data-wow-delay="0.3s">{{ detail.hero_title }}</h1>
                <p class="lead mt-3 wow fadeInUp" data-wow-delay="0.45s">{{ detail.hero_subtitle }}</p>
            </div>

            <!-- Card / Image -->
            <div class="col-lg-5 mt-4 mt-lg-0 wow fadeInRight" data-wow-delay="0.35s">
                <div class="info-card visa-card shadow-lg">
                    {% if visa_types %}
                    <span class="badge bg-warning text-dark mb-2 px-3 py-2 rounded-pill wow fadeInDown">Phổ biến</span>
                    <h5 class="mt-2 visa-title">Visa {{ detail.visa_types_summary}}</h5>
                    <p class="mb-2 text-muted"><strong>{{ detail.visa_processing_time }}</strong></p>
                    <hr>
                    <ul class="mb-0 visa-list ps-3">
                        <li class="wow fadeInUp" data-wow-delay="0.15s">{{ detail.visa_highlight_note_1 }}</li>
                        <li class="wow fadeInUp" data-wow-delay="0.25s">{{ detail.visa_highlight_note_2 }}</li>
                        <li class="wow fadeInUp" data-wow-delay="0.35s">{{ detail.visa_highlight_note_3 }}</li>
                    </ul>
                    {% endif %}
                </div>
            </div>

        </div>
    </div>
</section>

<!-- GIỚI THIỆU -->
<div class="row g-4 mb-5 wow fadeInUp mt-2" data-wow-delay="0.2s">
    <div class="col-12">
        <div class="p-4 info-card shadow-sm">
            <h3 class="section-title">{{ detail.overview_title }}</h3>
            <p class="mt-2 mb-0">{{ detail.overview_content|safe }}</p>
        </div>
    </div>
</div>

<!-- SECTIONS -->
{% for section in sections %}
<div class="row g-5 align-items-center mb-5 alt-row">
    {% if section.image_left %}
    <div class="col-lg-6 wow fadeInLeft" data-wow-delay="0.15s">
        {% if section.image %}
        <div class="rounded overflow-hidden shadow-sm">
            <img src="{{ section.image.url }}" class="w-100 wow fadeInUp" data-wow-delay="0.2s" style="height:180px;object-fit:cover;">
        </div>
        {% endif %}
    </div>
    <div class="col-lg-6 wow fadeInRight" data-wow-delay="0.25s">
        <h3 class="fw-semibold">{{ section.title }}</h3>
        <div class="section-text">
            {{ section.content|safe }}
        </div>
    </div>
    {% else %}
    <div class="col-lg-6 order-lg-2 wow fadeInRight" data-wow-delay="0.15s">
        {% if section.image %}
        <div class="rounded overflow-hidden shadow-sm">
            <img src="{{ section.image.url }}" class="w-100 wow fadeInUp" data-wow-delay="0.2s" style="height:180px;object-fit:cover;">
        </div>
        {% endif %}
    </div>
    <div class="col-lg-6 order-lg-1 wow fadeInLeft" data-wow-delay="0.25s">
        <h3 class="fw-semibold">{{ section.title }}</h3>
        <div class="section-text">
            {{ section.content|safe }}
        </div>
    </div>
    {% endif %}
</div>
{% endfor %}

<div class="row g-5 align-items-center mb-5">
  <!-- Ảnh -->
  <div class="col-lg-6 order-lg-2 wow fadeInRight"
       data-wow-delay="0.2s"
       data-wow-duration="1.1s">

      <div class="rounded overflow-hidden shadow-sm wow zoomIn"
           data-wow-delay="0.35s"
           data-wow-duration="1s">

          <img src="{{ country.cover_image.url }}"
               class="w-100"
               style="height:180px;object-fit:cover;">
      </div>
  </div>

  <!-- Nội dung -->
  <div class="col-lg-6 order-lg-1 wow fadeInLeft"
       data-wow-delay="0.25s"
       data-wow-duration="1.1s">

      <h3 class="fw-semibold wow fadeInUp"
          data-wow-delay="0.35s">
          Những giấy tờ quan trọng
      </h3>

      <ul class="mt-3">
        <li class="wow fadeInUp" data-wow-delay="0.45s">{{ detail.cta_featured_requirement_1 }}</li>
        <li class="wow fadeInUp" data-wow-delay="0.55s">{{ detail.cta_featured_requirement_2 }}</li>
        <li class="wow fadeInUp" data-wow-delay="0.65s">{{ detail.cta_featured_requirement_3 }}</li>
        <li class="wow fadeInUp" data-wow-delay="0.75s">{{ detail.cta_featured_requirement_4 }}</li>
      </ul>

      {% if detail.cta_button_text %}
      <div class="mt-4 wow fadeInUp"
           data-wow-delay="0.9s">
        <a href="{{ detail.cta_button_link }}"
           class="btn btn-primary btn-lg px-4 pulse-soft">
          {{ detail.cta_button_text }}
        </a>
      </div>
      {% endif %}
  </div>
</div>

<!-- TIPS -->
<div class="row g-4 mb-5">
    {% for tip in tips %}
    <div class="col-md-6">
        <div class="p-4 info-card h-100 wow fadeInUp" data-wow-delay="{{ forloop.counter|floatformat:2 }}s">
            <h5 class="mb-3">{{ tip.get_tip_type_display }}</h5>
            <p>{{ tip.content }}</p>
        </div>
    </div>
    {% endfor %}
</div>

<!-- FAQ -->
<div class="row mb-5 wow fadeInUp" data-wow-delay="0.2s">
    <div class="col-12">
        <div class="info-card p-4">
            <h4 class="section-title">Câu hỏi thường gặp</h4>
            <div class="accordion mt-3" id="faq">
                {% for faq in faqs %}
                <div class="accordion-item wow fadeInUp" data-wow-delay="{{ forloop.counter|floatformat:2 }}s">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" data-bs-toggle="collapse" data-bs-target="#collapse{{ forloop.counter }}">
                            {{ faq.question }}
                        </button>
                    </h2>
                    <div id="collapse{{ forloop.counter }}" class="accordion-collapse collapse" data-bs-parent="#faq">
                        <div class="accordion-body">{{ faq.answer }}</div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<!-- CTA -->
<div class="row mb-5">
    <div class="col-12">
        <div class="cta d-flex flex-column flex-md-row justify-content-between align-items-center wow fadeInUp" data-wow-delay="0.3s">
            <div>
                <h5 class="text-muted mb-1">Cần hỗ trợ chuẩn bị hồ sơ?</h5>
                <p class="mb-0">Đội ngũ chúng tôi tư vấn miễn phí, kiểm tra hồ sơ & tối ưu thư giải trình.</p>
            </div>
            <div class="mt-3 mt-md-0">
                <a href="{% url 'pages:lien-he' %}" class="btn btn-lg btn-light pulse-soft">Liên hệ tư vấn</a>
            </div>
        </div>
    </div>
</div>

{% endblock %}
